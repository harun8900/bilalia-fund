<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>صندوق البلالية</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="background:#050a18; color:white; text-align:center; padding:20px;">
    <h2>إضافة شهر جديد</h2>
    <input type="text" id="mName" placeholder="مثلاً: فبراير 2026" style="padding:10px;">
    <button onclick="addM()" style="padding:10px; background:cyan;">إضافة الآن</button>
    
    <div id="msg" style="margin-top:20px;">جاري فحص السحابة...</div>
    <ul id="list" style="list-style:none; padding:0;"></ul>

    <script>
        const URL = "https://xuiwkvrhatcoovfozsq.supabase.co";
        const KEY = "sb_publishable_T2ltCUtwwPR4b_Oh_dOPFQ_qfcCmFfM";
        const _db = supabase.createClient(URL, KEY);

        async function addM() {
            const n = document.getElementById('mName').value;
            const res = await _db.from('months').insert([{name: n}]);
            if(res.error) {
                document.getElementById('msg').innerText = "خطأ: " + res.error.message;
            } else {
                document.getElementById('msg').innerText = "تمت الإضافة بنجاح! ✅";
                load();
            }
        }

        async function load() {
            const { data } = await _db.from('months').select('*');
            const list = document.getElementById('list');
            list.innerHTML = "";
            if(data) {
                document.getElementById('msg').innerText = "متصل بالسحابة ✅";
                data.forEach(m => { list.innerHTML += `<li>- ${m.name}</li>`; });
            }
        }
        load();
    </script>
</body>
</html>
